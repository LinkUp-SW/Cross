import 'package:flutter/material.dart';
import 'package:flutter_riverpod/flutter_riverpod.dart';
import 'package:flutter_screenutil/flutter_screenutil.dart';

class CustomSearchBar extends ConsumerWidget {
  final String userName;

  const CustomSearchBar({
    super.key,
    required this.userName,
  });

  @override
  Widget build(BuildContext context, WidgetRef ref) {
    return SizedBox(
      height: 50.h, // Increased height
      child: SearchAnchor.bar(
        suggestionsBuilder:
            (BuildContext context, SearchController searchController) {
          return [
            SizedBox(
              height: 100.h,
              child: ListView.builder(
                itemCount: 40,
                scrollDirection: Axis.horizontal,
                itemBuilder: (BuildContext context, index) {
                  return CircleAvatar(
                    backgroundColor: Colors.white,
                    child: Text('$index'),
                  );
                },
              ),
            ),
            SizedBox(
              height: 200.h, // Wrapped to avoid `Expanded` inside ListView
              child: ListView.builder(
                shrinkWrap: true,
                itemCount: 10,
                itemBuilder: (BuildContext context, index) {
                  return ListTile(
                    title: Text('Item $index'),
                  );
                },
              ),
            ),
          ];
        },
        viewTrailing: const [
          Icon(Icons.qr_code),
        ],
        barHintText: userName, // Uses the user's name
        barLeading: const Icon(Icons.search),
      ),
    );
  }
}
